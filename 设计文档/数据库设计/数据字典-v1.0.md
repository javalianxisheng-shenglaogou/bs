# 多站点CMS系统 - 数据字典

**版本**：v1.0  
**更新日期**：2025-10-07  
**数据库**：MySQL 8.0  
**字符集**：utf8mb4  
**排序规则**：utf8mb4_unicode_ci

---

## 目录

1. [用户管理模块](#1-用户管理模块)
2. [站点管理模块](#2-站点管理模块)
3. [内容管理模块](#3-内容管理模块)
4. [工作流管理模块](#4-工作流管理模块)
5. [系统管理模块](#5-系统管理模块)

---

## 1. 用户管理模块

### 1.1 users（用户表）

**表说明**：存储系统用户基本信息

| 字段名 | 类型 | 长度 | 允许空 | 默认值 | 说明 |
|--------|------|------|--------|--------|------|
| id | BIGINT | - | NO | AUTO_INCREMENT | 用户ID（主键） |
| username | VARCHAR | 50 | NO | - | 用户名（唯一） |
| password_hash | VARCHAR | 255 | NO | - | 密码哈希值（BCrypt加密） |
| email | VARCHAR | 100 | YES | NULL | 邮箱（唯一） |
| phone | VARCHAR | 20 | YES | NULL | 手机号 |
| nickname | VARCHAR | 50 | YES | NULL | 昵称 |
| avatar_url | VARCHAR | 500 | YES | NULL | 头像URL |
| status | VARCHAR | 20 | NO | 'ACTIVE' | 状态：ACTIVE-激活，INACTIVE-未激活，LOCKED-锁定 |
| last_login_at | DATETIME | - | YES | NULL | 最后登录时间 |
| last_login_ip | VARCHAR | 50 | YES | NULL | 最后登录IP |
| created_at | DATETIME | - | NO | CURRENT_TIMESTAMP | 创建时间 |
| updated_at | DATETIME | - | NO | CURRENT_TIMESTAMP ON UPDATE | 更新时间 |
| created_by | BIGINT | - | YES | NULL | 创建人ID |
| updated_by | BIGINT | - | YES | NULL | 更新人ID |
| deleted | TINYINT | 1 | NO | 0 | 软删除标记（0-未删除，1-已删除） |
| version | INT | - | NO | 0 | 乐观锁版本号 |

**索引**：
- PRIMARY KEY (`id`)
- UNIQUE KEY `username` (`username`)
- UNIQUE KEY `email` (`email`)
- INDEX `idx_username` (`username`)
- INDEX `idx_email` (`email`)
- INDEX `idx_status` (`status`)

**外键**：无

---

### 1.2 roles（角色表）

**表说明**：存储系统角色信息

| 字段名 | 类型 | 长度 | 允许空 | 默认值 | 说明 |
|--------|------|------|--------|--------|------|
| id | BIGINT | - | NO | AUTO_INCREMENT | 角色ID（主键） |
| name | VARCHAR | 50 | NO | - | 角色名称 |
| code | VARCHAR | 50 | NO | - | 角色编码（唯一） |
| description | VARCHAR | 200 | YES | NULL | 角色描述 |
| is_system | TINYINT | 1 | NO | 0 | 系统角色标记（0-否，1-是） |
| sort_order | INT | - | NO | 0 | 排序顺序 |
| created_at | DATETIME | - | NO | CURRENT_TIMESTAMP | 创建时间 |
| updated_at | DATETIME | - | NO | CURRENT_TIMESTAMP ON UPDATE | 更新时间 |
| created_by | BIGINT | - | YES | NULL | 创建人ID |
| updated_by | BIGINT | - | YES | NULL | 更新人ID |
| deleted | TINYINT | 1 | NO | 0 | 软删除标记 |

**索引**：
- PRIMARY KEY (`id`)
- UNIQUE KEY `code` (`code`)
- INDEX `idx_code` (`code`)

**外键**：无

---

### 1.3 permissions（权限表）

**表说明**：存储系统权限信息

| 字段名 | 类型 | 长度 | 允许空 | 默认值 | 说明 |
|--------|------|------|--------|--------|------|
| id | BIGINT | - | NO | AUTO_INCREMENT | 权限ID（主键） |
| name | VARCHAR | 100 | NO | - | 权限名称 |
| code | VARCHAR | 100 | NO | - | 权限编码（唯一） |
| description | VARCHAR | 200 | YES | NULL | 权限描述 |
| module | VARCHAR | 50 | NO | - | 所属模块 |
| resource | VARCHAR | 50 | NO | - | 资源名称 |
| action | VARCHAR | 50 | NO | - | 操作类型 |
| is_system | TINYINT | 1 | NO | 0 | 系统权限标记 |
| sort_order | INT | - | NO | 0 | 排序顺序 |
| created_at | DATETIME | - | NO | CURRENT_TIMESTAMP | 创建时间 |
| updated_at | DATETIME | - | NO | CURRENT_TIMESTAMP ON UPDATE | 更新时间 |
| created_by | BIGINT | - | YES | NULL | 创建人ID |
| updated_by | BIGINT | - | YES | NULL | 更新人ID |
| deleted | TINYINT | 1 | NO | 0 | 软删除标记 |

**索引**：
- PRIMARY KEY (`id`)
- UNIQUE KEY `code` (`code`)
- INDEX `idx_code` (`code`)
- INDEX `idx_module` (`module`)

**外键**：无

---

### 1.4 user_roles（用户角色关联表）

**表说明**：存储用户和角色的多对多关系

| 字段名 | 类型 | 长度 | 允许空 | 默认值 | 说明 |
|--------|------|------|--------|--------|------|
| id | BIGINT | - | NO | AUTO_INCREMENT | 主键 |
| user_id | BIGINT | - | NO | - | 用户ID |
| role_id | BIGINT | - | NO | - | 角色ID |
| granted_by | BIGINT | - | YES | NULL | 授权人ID |
| granted_at | DATETIME | - | NO | CURRENT_TIMESTAMP | 授权时间 |

**索引**：
- PRIMARY KEY (`id`)
- UNIQUE KEY `uk_user_role` (`user_id`, `role_id`)
- INDEX `idx_user_id` (`user_id`)
- INDEX `idx_role_id` (`role_id`)

**外键**：无（建议在应用层维护关系）

---

### 1.5 role_permissions（角色权限关联表）

**表说明**：存储角色和权限的多对多关系

| 字段名 | 类型 | 长度 | 允许空 | 默认值 | 说明 |
|--------|------|------|--------|--------|------|
| id | BIGINT | - | NO | AUTO_INCREMENT | 主键 |
| role_id | BIGINT | - | NO | - | 角色ID |
| permission_id | BIGINT | - | NO | - | 权限ID |

**索引**：
- PRIMARY KEY (`id`)
- UNIQUE KEY `uk_role_permission` (`role_id`, `permission_id`)
- INDEX `idx_role_id` (`role_id`)
- INDEX `idx_permission_id` (`permission_id`)

**外键**：无（建议在应用层维护关系）

---

## 2. 站点管理模块

### 2.1 sites（站点表）

**表说明**：存储多站点信息

| 字段名 | 类型 | 长度 | 允许空 | 默认值 | 说明 |
|--------|------|------|--------|--------|------|
| id | BIGINT | - | NO | AUTO_INCREMENT | 站点ID（主键） |
| name | VARCHAR | 100 | NO | - | 站点名称 |
| code | VARCHAR | 50 | NO | - | 站点编码（唯一） |
| domain | VARCHAR | 200 | YES | NULL | 站点域名 |
| description | VARCHAR | 500 | YES | NULL | 站点描述 |
| logo_url | VARCHAR | 500 | YES | NULL | Logo URL |
| favicon_url | VARCHAR | 500 | YES | NULL | Favicon URL |
| language | VARCHAR | 20 | YES | 'zh-CN' | 语言 |
| timezone | VARCHAR | 50 | YES | 'Asia/Shanghai' | 时区 |
| status | VARCHAR | 20 | NO | 'ACTIVE' | 状态：ACTIVE-激活，INACTIVE-未激活 |
| is_default | TINYINT | 1 | NO | 0 | 默认站点标记 |
| seo_title | VARCHAR | 200 | YES | NULL | SEO标题 |
| seo_keywords | VARCHAR | 500 | YES | NULL | SEO关键词 |
| seo_description | VARCHAR | 1000 | YES | NULL | SEO描述 |
| contact_email | VARCHAR | 100 | YES | NULL | 联系邮箱 |
| contact_phone | VARCHAR | 50 | YES | NULL | 联系电话 |
| contact_address | VARCHAR | 500 | YES | NULL | 联系地址 |
| created_at | DATETIME | - | NO | CURRENT_TIMESTAMP | 创建时间 |
| updated_at | DATETIME | - | NO | CURRENT_TIMESTAMP ON UPDATE | 更新时间 |
| created_by | BIGINT | - | YES | NULL | 创建人ID |
| updated_by | BIGINT | - | YES | NULL | 更新人ID |
| deleted | TINYINT | 1 | NO | 0 | 软删除标记 |
| version | INT | - | NO | 0 | 乐观锁版本号 |

**索引**：
- PRIMARY KEY (`id`)
- UNIQUE KEY `code` (`code`)
- INDEX `idx_code` (`code`)
- INDEX `idx_status` (`status`)

**外键**：无

---

## 3. 内容管理模块

### 3.1 categories（分类表）

**表说明**：存储内容分类信息（树形结构）

| 字段名 | 类型 | 长度 | 允许空 | 默认值 | 说明 |
|--------|------|------|--------|--------|------|
| id | BIGINT | - | NO | AUTO_INCREMENT | 分类ID（主键） |
| site_id | BIGINT | - | NO | - | 站点ID |
| parent_id | BIGINT | - | YES | NULL | 父分类ID |
| name | VARCHAR | 100 | NO | - | 分类名称 |
| code | VARCHAR | 50 | NO | - | 分类编码 |
| description | VARCHAR | 500 | YES | NULL | 分类描述 |
| icon | VARCHAR | 200 | YES | NULL | 图标 |
| sort_order | INT | - | NO | 0 | 排序顺序 |
| level | INT | - | NO | 1 | 层级（1为顶级） |
| path | VARCHAR | 500 | NO | - | 路径（如：/1/2/3） |
| is_visible | TINYINT | 1 | NO | 1 | 是否可见 |
| created_at | DATETIME | - | NO | CURRENT_TIMESTAMP | 创建时间 |
| updated_at | DATETIME | - | NO | CURRENT_TIMESTAMP ON UPDATE | 更新时间 |
| created_by | BIGINT | - | YES | NULL | 创建人ID |
| updated_by | BIGINT | - | YES | NULL | 更新人ID |
| deleted | TINYINT | 1 | NO | 0 | 软删除标记 |
| version | INT | - | NO | 0 | 乐观锁版本号 |

**索引**：
- PRIMARY KEY (`id`)
- UNIQUE KEY `uk_site_code` (`site_id`, `code`)
- INDEX `idx_site_id` (`site_id`)
- INDEX `idx_parent_id` (`parent_id`)
- INDEX `idx_path` (`path`(255))

**外键**：无

---

### 3.2 contents（内容表）

**表说明**：存储内容信息

| 字段名 | 类型 | 长度 | 允许空 | 默认值 | 说明 |
|--------|------|------|--------|--------|------|
| id | BIGINT | - | NO | AUTO_INCREMENT | 内容ID（主键） |
| site_id | BIGINT | - | NO | - | 站点ID |
| category_id | BIGINT | - | YES | NULL | 分类ID |
| title | VARCHAR | 200 | NO | - | 标题 |
| slug | VARCHAR | 200 | YES | NULL | URL别名 |
| summary | TEXT | - | YES | NULL | 摘要 |
| content | LONGTEXT | - | YES | NULL | 内容（富文本） |
| cover_image | VARCHAR | 500 | YES | NULL | 封面图URL |
| content_type | VARCHAR | 20 | NO | 'ARTICLE' | 内容类型 |
| author_id | BIGINT | - | YES | NULL | 作者ID |
| author_name | VARCHAR | 50 | YES | NULL | 作者名称 |
| status | VARCHAR | 20 | NO | 'DRAFT' | 状态：DRAFT-草稿，PUBLISHED-已发布，ARCHIVED-已归档 |
| is_top | TINYINT | 1 | NO | 0 | 是否置顶 |
| is_recommend | TINYINT | 1 | NO | 0 | 是否推荐 |
| view_count | BIGINT | - | NO | 0 | 浏览次数 |
| published_at | DATETIME | - | YES | NULL | 发布时间 |
| created_at | DATETIME | - | NO | CURRENT_TIMESTAMP | 创建时间 |
| updated_at | DATETIME | - | NO | CURRENT_TIMESTAMP ON UPDATE | 更新时间 |
| created_by | BIGINT | - | YES | NULL | 创建人ID |
| updated_by | BIGINT | - | YES | NULL | 更新人ID |
| deleted | TINYINT | 1 | NO | 0 | 软删除标记 |
| version | INT | - | NO | 0 | 乐观锁版本号 |

**索引**：
- PRIMARY KEY (`id`)
- UNIQUE KEY `uk_site_slug` (`site_id`, `slug`)
- INDEX `idx_site_id` (`site_id`)
- INDEX `idx_category_id` (`category_id`)
- INDEX `idx_status` (`status`)
- INDEX `idx_author_id` (`author_id`)

**外键**：无

---

### 3.3 content_versions（内容版本表）

**表说明**：存储内容版本历史

| 字段名 | 类型 | 长度 | 允许空 | 默认值 | 说明 |
|--------|------|------|--------|--------|------|
| id | BIGINT | - | NO | AUTO_INCREMENT | 版本ID（主键） |
| content_id | BIGINT | - | NO | - | 关联的内容ID |
| version_number | INT | - | NO | - | 版本号（从1开始递增） |
| title | VARCHAR | 500 | NO | - | 标题快照 |
| slug | VARCHAR | 200 | YES | NULL | URL别名快照 |
| summary | TEXT | - | YES | NULL | 摘要快照 |
| content | LONGTEXT | - | YES | NULL | 内容快照 |
| cover_image | VARCHAR | 500 | YES | NULL | 封面图快照 |
| content_type | VARCHAR | 50 | YES | NULL | 内容类型快照 |
| status | VARCHAR | 50 | YES | NULL | 状态快照 |
| is_top | BOOLEAN | - | YES | FALSE | 是否置顶快照 |
| is_featured | BOOLEAN | - | YES | FALSE | 是否推荐快照 |
| is_original | BOOLEAN | - | YES | FALSE | 是否原创快照 |
| tags | JSON | - | YES | NULL | 标签快照（JSON数组） |
| metadata | JSON | - | YES | NULL | 元数据快照（JSON对象） |
| change_summary | VARCHAR | 500 | YES | NULL | 修改摘要 |
| change_type | VARCHAR | 50 | NO | - | 修改类型：CREATE/UPDATE/PUBLISH/UNPUBLISH/RESTORE |
| created_by | BIGINT | - | NO | - | 创建人ID |
| created_by_name | VARCHAR | 100 | YES | NULL | 创建人姓名 |
| created_at | DATETIME | - | NO | CURRENT_TIMESTAMP | 创建时间 |
| is_tagged | BOOLEAN | - | YES | FALSE | 是否标记为重要版本 |
| tag_name | VARCHAR | 100 | YES | NULL | 版本标签名称 |
| file_size | BIGINT | - | YES | NULL | 版本数据大小（字节） |

**索引**：
- PRIMARY KEY (`id`)
- INDEX `idx_content_id` (`content_id`)
- INDEX `idx_version_number` (`content_id`, `version_number`)
- INDEX `idx_created_at` (`created_at`)
- INDEX `idx_created_by` (`created_by`)
- INDEX `idx_change_type` (`change_type`)

**外键**：
- FOREIGN KEY `fk_content_versions_content_id` (`content_id`) REFERENCES `contents`(`id`) ON DELETE CASCADE

---

### 3.4 content_version_logs（内容版本操作日志表）

**表说明**：存储内容版本操作日志

| 字段名 | 类型 | 长度 | 允许空 | 默认值 | 说明 |
|--------|------|------|--------|--------|------|
| id | BIGINT | - | NO | AUTO_INCREMENT | 日志ID（主键） |
| content_id | BIGINT | - | NO | - | 内容ID |
| version_id | BIGINT | - | YES | NULL | 版本ID |
| operation_type | VARCHAR | 50 | NO | - | 操作类型：CREATE/VIEW/RESTORE/DELETE/TAG/COMPARE |
| operator_id | BIGINT | - | NO | - | 操作人ID |
| operator_name | VARCHAR | 100 | YES | NULL | 操作人姓名 |
| operation_detail | JSON | - | YES | NULL | 操作详情（JSON对象） |
| ip_address | VARCHAR | 50 | YES | NULL | IP地址 |
| user_agent | VARCHAR | 500 | YES | NULL | 用户代理 |
| created_at | DATETIME | - | NO | CURRENT_TIMESTAMP | 操作时间 |

**索引**：
- PRIMARY KEY (`id`)
- INDEX `idx_content_id` (`content_id`)
- INDEX `idx_version_id` (`version_id`)
- INDEX `idx_operator_id` (`operator_id`)
- INDEX `idx_operation_type` (`operation_type`)
- INDEX `idx_created_at` (`created_at`)

**外键**：无

---

## 4. 工作流管理模块

### 4.1 workflows（工作流定义表）

**表说明**：存储工作流定义信息

| 字段名 | 类型 | 长度 | 允许空 | 默认值 | 说明 |
|--------|------|------|--------|--------|------|
| id | BIGINT | - | NO | AUTO_INCREMENT | 工作流ID（主键） |
| site_id | BIGINT | - | YES | NULL | 站点ID（NULL表示全局工作流） |
| name | VARCHAR | 100 | NO | - | 工作流名称 |
| code | VARCHAR | 50 | NO | - | 工作流代码（唯一） |
| description | TEXT | - | YES | NULL | 工作流描述 |
| workflow_type | ENUM | - | YES | 'CONTENT_APPROVAL' | 工作流类型：CONTENT_APPROVAL/USER_APPROVAL/CUSTOM |
| trigger_event | VARCHAR | 50 | YES | NULL | 触发事件 |
| status | ENUM | - | YES | 'DRAFT' | 状态：ACTIVE/INACTIVE/DRAFT |
| version | INT | - | YES | 1 | 版本号 |
| created_at | DATETIME | - | NO | CURRENT_TIMESTAMP | 创建时间 |
| updated_at | DATETIME | - | NO | CURRENT_TIMESTAMP ON UPDATE | 更新时间 |
| created_by | BIGINT | - | YES | NULL | 创建人ID |
| updated_by | BIGINT | - | YES | NULL | 更新人ID |
| deleted | TINYINT | 1 | NO | 0 | 软删除标记 |

**索引**：
- PRIMARY KEY (`id`)
- UNIQUE KEY `code` (`code`)
- INDEX `idx_site_id` (`site_id`)
- INDEX `idx_code` (`code`)
- INDEX `idx_status` (`status`)
- INDEX `idx_deleted` (`deleted`)

**外键**：无

---


