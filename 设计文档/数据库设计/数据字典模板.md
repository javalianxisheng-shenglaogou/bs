# 多站点CMS系统 - 数据字典

**版本**：v1.0  
**更新日期**：2025-10-07  
**数据库**：MySQL 8.0  
**字符集**：utf8mb4  

---

## 1. users（用户表）

**表说明**：存储系统用户信息

| 字段名 | 类型 | 长度 | 允许空 | 默认值 | 说明 |
|--------|------|------|--------|--------|------|
| id | BIGINT | - | NO | AUTO_INCREMENT | 用户ID（主键） |
| username | VARCHAR | 50 | NO | - | 用户名（唯一） |
| password | VARCHAR | 255 | NO | - | 密码（BCrypt加密） |
| nickname | VARCHAR | 100 | YES | NULL | 昵称 |
| email | VARCHAR | 100 | YES | NULL | 邮箱 |
| phone | VARCHAR | 20 | YES | NULL | 手机号 |
| avatar | VARCHAR | 255 | YES | NULL | 头像URL |
| is_active | TINYINT | 1 | NO | 1 | 是否激活（0-否，1-是） |
| is_deleted | TINYINT | 1 | NO | 0 | 是否删除（0-否，1-是） |
| created_at | DATETIME | - | NO | CURRENT_TIMESTAMP | 创建时间 |
| updated_at | DATETIME | - | NO | CURRENT_TIMESTAMP ON UPDATE | 更新时间 |
| deleted_at | DATETIME | - | YES | NULL | 删除时间 |

**索引**：
- PRIMARY KEY (`id`)
- UNIQUE KEY `uk_username` (`username`)
- KEY `idx_email` (`email`)
- KEY `idx_is_active` (`is_active`)
- KEY `idx_is_deleted` (`is_deleted`)

**外键**：无

---

## 2. roles（角色表）

**表说明**：存储系统角色信息

| 字段名 | 类型 | 长度 | 允许空 | 默认值 | 说明 |
|--------|------|------|--------|--------|------|
| id | BIGINT | - | NO | AUTO_INCREMENT | 角色ID（主键） |
| name | VARCHAR | 50 | NO | - | 角色名称（唯一） |
| code | VARCHAR | 50 | NO | - | 角色编码（唯一） |
| description | VARCHAR | 255 | YES | NULL | 角色描述 |
| is_active | TINYINT | 1 | NO | 1 | 是否激活 |
| created_at | DATETIME | - | NO | CURRENT_TIMESTAMP | 创建时间 |
| updated_at | DATETIME | - | NO | CURRENT_TIMESTAMP ON UPDATE | 更新时间 |

**索引**：
- PRIMARY KEY (`id`)
- UNIQUE KEY `uk_name` (`name`)
- UNIQUE KEY `uk_code` (`code`)

**外键**：无

---

## 3. permissions（权限表）

**表说明**：存储系统权限信息

| 字段名 | 类型 | 长度 | 允许空 | 默认值 | 说明 |
|--------|------|------|--------|--------|------|
| id | BIGINT | - | NO | AUTO_INCREMENT | 权限ID（主键） |
| name | VARCHAR | 100 | NO | - | 权限名称 |
| code | VARCHAR | 100 | NO | - | 权限编码（唯一） |
| resource | VARCHAR | 100 | YES | NULL | 资源路径 |
| action | VARCHAR | 50 | YES | NULL | 操作类型 |
| description | VARCHAR | 255 | YES | NULL | 权限描述 |
| created_at | DATETIME | - | NO | CURRENT_TIMESTAMP | 创建时间 |
| updated_at | DATETIME | - | NO | CURRENT_TIMESTAMP ON UPDATE | 更新时间 |

**索引**：
- PRIMARY KEY (`id`)
- UNIQUE KEY `uk_code` (`code`)

**外键**：无

---

## 4. user_roles（用户角色关联表）

**表说明**：存储用户和角色的多对多关系

| 字段名 | 类型 | 长度 | 允许空 | 默认值 | 说明 |
|--------|------|------|--------|--------|------|
| id | BIGINT | - | NO | AUTO_INCREMENT | 主键 |
| user_id | BIGINT | - | NO | - | 用户ID |
| role_id | BIGINT | - | NO | - | 角色ID |
| created_at | DATETIME | - | NO | CURRENT_TIMESTAMP | 创建时间 |

**索引**：
- PRIMARY KEY (`id`)
- UNIQUE KEY `uk_user_role` (`user_id`, `role_id`)
- KEY `idx_user_id` (`user_id`)
- KEY `idx_role_id` (`role_id`)

**外键**：
- FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE CASCADE
- FOREIGN KEY (`role_id`) REFERENCES `roles` (`id`) ON DELETE CASCADE

---

## 5. role_permissions（角色权限关联表）

**表说明**：存储角色和权限的多对多关系

| 字段名 | 类型 | 长度 | 允许空 | 默认值 | 说明 |
|--------|------|------|--------|--------|------|
| id | BIGINT | - | NO | AUTO_INCREMENT | 主键 |
| role_id | BIGINT | - | NO | - | 角色ID |
| permission_id | BIGINT | - | NO | - | 权限ID |
| created_at | DATETIME | - | NO | CURRENT_TIMESTAMP | 创建时间 |

**索引**：
- PRIMARY KEY (`id`)
- UNIQUE KEY `uk_role_permission` (`role_id`, `permission_id`)
- KEY `idx_role_id` (`role_id`)
- KEY `idx_permission_id` (`permission_id`)

**外键**：
- FOREIGN KEY (`role_id`) REFERENCES `roles` (`id`) ON DELETE CASCADE
- FOREIGN KEY (`permission_id`) REFERENCES `permissions` (`id`) ON DELETE CASCADE

---

## 6. sites（站点表）

**表说明**：存储站点信息

| 字段名 | 类型 | 长度 | 允许空 | 默认值 | 说明 |
|--------|------|------|--------|--------|------|
| id | BIGINT | - | NO | AUTO_INCREMENT | 站点ID（主键） |
| name | VARCHAR | 100 | NO | - | 站点名称 |
| domain | VARCHAR | 255 | NO | - | 站点域名（唯一） |
| description | TEXT | - | YES | NULL | 站点描述 |
| logo | VARCHAR | 255 | YES | NULL | 站点Logo |
| is_active | TINYINT | 1 | NO | 1 | 是否激活 |
| created_by | BIGINT | - | NO | - | 创建人ID |
| created_at | DATETIME | - | NO | CURRENT_TIMESTAMP | 创建时间 |
| updated_at | DATETIME | - | NO | CURRENT_TIMESTAMP ON UPDATE | 更新时间 |

**索引**：
- PRIMARY KEY (`id`)
- UNIQUE KEY `uk_domain` (`domain`)
- KEY `idx_created_by` (`created_by`)
- KEY `idx_is_active` (`is_active`)

**外键**：
- FOREIGN KEY (`created_by`) REFERENCES `users` (`id`)

---

## 7. contents（内容表）

**表说明**：存储内容信息

| 字段名 | 类型 | 长度 | 允许空 | 默认值 | 说明 |
|--------|------|------|--------|--------|------|
| id | BIGINT | - | NO | AUTO_INCREMENT | 内容ID（主键） |
| site_id | BIGINT | - | NO | - | 站点ID |
| category_id | BIGINT | - | YES | NULL | 分类ID |
| title | VARCHAR | 255 | NO | - | 标题 |
| content | LONGTEXT | - | YES | NULL | 内容 |
| summary | TEXT | - | YES | NULL | 摘要 |
| cover_image | VARCHAR | 255 | YES | NULL | 封面图 |
| author_id | BIGINT | - | NO | - | 作者ID |
| status | TINYINT | 1 | NO | 0 | 状态（0-草稿，1-已发布，2-已下线） |
| view_count | INT | - | NO | 0 | 浏览次数 |
| is_deleted | TINYINT | 1 | NO | 0 | 是否删除 |
| published_at | DATETIME | - | YES | NULL | 发布时间 |
| created_at | DATETIME | - | NO | CURRENT_TIMESTAMP | 创建时间 |
| updated_at | DATETIME | - | NO | CURRENT_TIMESTAMP ON UPDATE | 更新时间 |
| deleted_at | DATETIME | - | YES | NULL | 删除时间 |

**索引**：
- PRIMARY KEY (`id`)
- KEY `idx_site_id` (`site_id`)
- KEY `idx_category_id` (`category_id`)
- KEY `idx_author_id` (`author_id`)
- KEY `idx_status` (`status`)
- KEY `idx_is_deleted` (`is_deleted`)
- KEY `idx_published_at` (`published_at`)

**外键**：
- FOREIGN KEY (`site_id`) REFERENCES `sites` (`id`)
- FOREIGN KEY (`category_id`) REFERENCES `categories` (`id`)
- FOREIGN KEY (`author_id`) REFERENCES `users` (`id`)

---

## 8. content_versions（内容版本表）

**表说明**：存储内容版本历史

| 字段名 | 类型 | 长度 | 允许空 | 默认值 | 说明 |
|--------|------|------|--------|--------|------|
| id | BIGINT | - | NO | AUTO_INCREMENT | 版本ID（主键） |
| content_id | BIGINT | - | NO | - | 内容ID |
| version_number | INT | - | NO | - | 版本号 |
| title | VARCHAR | 255 | NO | - | 标题快照 |
| content | LONGTEXT | - | YES | NULL | 内容快照 |
| summary | TEXT | - | YES | NULL | 摘要快照 |
| change_description | VARCHAR | 500 | YES | NULL | 变更说明 |
| tag | VARCHAR | 50 | YES | NULL | 版本标签 |
| created_by | BIGINT | - | NO | - | 创建人ID |
| created_at | DATETIME | - | NO | CURRENT_TIMESTAMP | 创建时间 |

**索引**：
- PRIMARY KEY (`id`)
- UNIQUE KEY `uk_content_version` (`content_id`, `version_number`)
- KEY `idx_content_id` (`content_id`)
- KEY `idx_created_by` (`created_by`)
- KEY `idx_created_at` (`created_at`)

**外键**：
- FOREIGN KEY (`content_id`) REFERENCES `contents` (`id`) ON DELETE CASCADE
- FOREIGN KEY (`created_by`) REFERENCES `users` (`id`)

---

## 9. categories（分类表）

**表说明**：存储内容分类信息（树形结构）

| 字段名 | 类型 | 长度 | 允许空 | 默认值 | 说明 |
|--------|------|------|--------|--------|------|
| id | BIGINT | - | NO | AUTO_INCREMENT | 分类ID（主键） |
| site_id | BIGINT | - | NO | - | 站点ID |
| parent_id | BIGINT | - | YES | NULL | 父分类ID |
| name | VARCHAR | 100 | NO | - | 分类名称 |
| slug | VARCHAR | 100 | NO | - | URL别名 |
| description | TEXT | - | YES | NULL | 分类描述 |
| sort_order | INT | - | NO | 0 | 排序顺序 |
| is_active | TINYINT | 1 | NO | 1 | 是否激活 |
| created_at | DATETIME | - | NO | CURRENT_TIMESTAMP | 创建时间 |
| updated_at | DATETIME | - | NO | CURRENT_TIMESTAMP ON UPDATE | 更新时间 |

**索引**：
- PRIMARY KEY (`id`)
- KEY `idx_site_id` (`site_id`)
- KEY `idx_parent_id` (`parent_id`)
- KEY `idx_slug` (`slug`)
- KEY `idx_sort_order` (`sort_order`)

**外键**：
- FOREIGN KEY (`site_id`) REFERENCES `sites` (`id`)
- FOREIGN KEY (`parent_id`) REFERENCES `categories` (`id`)

---

## 10. system_logs（系统日志表）

**表说明**：存储系统操作日志

| 字段名 | 类型 | 长度 | 允许空 | 默认值 | 说明 |
|--------|------|------|--------|--------|------|
| id | BIGINT | - | NO | AUTO_INCREMENT | 日志ID（主键） |
| user_id | BIGINT | - | YES | NULL | 操作用户ID |
| action | VARCHAR | 100 | NO | - | 操作类型 |
| resource | VARCHAR | 100 | YES | NULL | 操作资源 |
| resource_id | BIGINT | - | YES | NULL | 资源ID |
| ip_address | VARCHAR | 50 | YES | NULL | IP地址 |
| user_agent | VARCHAR | 500 | YES | NULL | 用户代理 |
| request_method | VARCHAR | 10 | YES | NULL | 请求方法 |
| request_url | VARCHAR | 500 | YES | NULL | 请求URL |
| status | VARCHAR | 20 | YES | NULL | 状态 |
| error_message | TEXT | - | YES | NULL | 错误信息 |
| created_at | DATETIME | - | NO | CURRENT_TIMESTAMP | 创建时间 |

**索引**：
- PRIMARY KEY (`id`)
- KEY `idx_user_id` (`user_id`)
- KEY `idx_action` (`action`)
- KEY `idx_resource` (`resource`)
- KEY `idx_created_at` (`created_at`)

**外键**：
- FOREIGN KEY (`user_id`) REFERENCES `users` (`id`)

---

## 附录

### 数据类型说明

| 类型 | 说明 | 使用场景 |
|------|------|----------|
| BIGINT | 大整数（-2^63 到 2^63-1） | 主键、外键、大数值 |
| INT | 整数（-2^31 到 2^31-1） | 计数、排序 |
| TINYINT | 小整数（-128 到 127） | 状态、布尔值 |
| VARCHAR(n) | 可变长度字符串 | 短文本 |
| TEXT | 长文本（最大65535字节） | 中等长度文本 |
| LONGTEXT | 超长文本（最大4GB） | 富文本内容 |
| DATETIME | 日期时间 | 时间戳 |
| DECIMAL(m,d) | 精确小数 | 金额、价格 |

### 索引类型说明

| 索引类型 | 说明 | 示例 |
|---------|------|------|
| PRIMARY KEY | 主键索引（唯一且非空） | `id` |
| UNIQUE KEY | 唯一索引 | `username`, `email` |
| KEY (INDEX) | 普通索引 | `created_at`, `status` |
| FOREIGN KEY | 外键索引 | `user_id`, `site_id` |

### 命名规范

- **表名**：小写字母，复数形式，下划线分隔
- **字段名**：小写字母，下划线分隔
- **索引名**：`idx_表名_字段名` 或 `uk_表名_字段名`（唯一索引）
- **外键名**：`fk_表名_关联表名`

---

**文档维护**：开发团队  
**最后更新**：2025-10-07

